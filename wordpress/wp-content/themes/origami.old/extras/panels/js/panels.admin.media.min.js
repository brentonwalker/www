/*
 GPL 2.0 http://www.gnu.org/licenses/gpl-2.0.html
*/
jQuery(function(c){var e=wp.media.editor.insert;wp.media.editor.insert=function(a){if(!c("#wp-content-wrap").hasClass("panels-active"))return e(a);if(-1!==a.indexOf("[gallery")){var b=wp.media.gallery.attachments(wp.shortcode.next("gallery",a).shortcode).models.map(function(a){return a.id}),b=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:b.join(",")});null==b?e(a):panels.addPanel(b,null,null,!0)}else if(-1!==a.indexOf("<a ")||-1!==a.indexOf("<img ")){var d=c(a);"A"==
d.prop("tagName")&&"IMG"==d.children().eq(0).prop("tagName")?b=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:d.attr("href"),src:d.children().eq(0).attr("src")}):"IMG"==d.prop("tagName")&&(b=c("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:d.children().eq(0).attr("src")}));null==b?e(a):panels.addPanel(b,null,null,!0)}else e(a)};c(".so-gallery-widget-select-attachments").live("click",function(a){if(!("undefined"===typeof wp||!wp.media||!wp.media.gallery)){a.preventDefault();
c(this);var b=c(".panels-admin-dialog:visible");a=b.find('*[name$="[ids]"]').val();if(0===a.indexOf("{demo")||0===a.indexOf("{default"))a="-";""==a&&null==c("#post_ID").val()&&(a="-");b.find(".ui-dialog-content").dialog("close");a=wp.media.gallery.edit('[gallery ids="'+a+'"]');a.state("gallery-edit").on("update",function(a){b.find(".ui-dialog-content").dialog("open");a=a.models.map(function(a){return a.id});b.find('input[name$="[ids]"]').val(a.join(","))});a.on("escape",function(){b.find(".ui-dialog-content").dialog("open")});
return!1}})});